<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="roomMapper">


	<resultMap type="room" id="roomResultSet">
		<result column="ROOM_NO" property="roomNo"/>
		<result column="HOUSE_NO" property="houseNo"/>
		<result column="ROOM_NAME" property="roomName"/>
		<result column="GENDER" property="gender"/>
		<result column="PEOPLE" property="people"/>
		<result column="AREA" property="area"/>
		<result column="DEPOSIT" property="deposit"/>
		<result column="RENT" property="rent"/>
		<result column="EXPENSE" property="expense"/>
		<result column="UTILITY" property="utility"/>
		<result column="AVAILABLE_DATE" property="availableDate"/>
		<result column="STATUS" property="status"/>
		<result column="HOUSE_NAME" property="houseName"/>
		<result column="HOUSE_TITLE" property="houseTitle"/>
		<result column="HOUSE_INTRODUCE" property="houseIntroduce"/>
		<result column="SHARE_SPACE" property="shareSpace"/>
		<result column="PERSONAL_SPACE" property="personalSpace"/>
		<result column="TRAFFIC" property="traffic"/>
		<result column="CONVENIENCE" property="convenience"/>
		<result column="ADDRESS" property="address"/>
		<result column="LATITUDE" property="latitude"/>
		<result column="LONGITUDE" property="longitude"/>
	</resultMap>

	
	<!-- 방 등록 -->
	<insert id="insertRoom" parameterType="room">
		INSERT
			INTO ROOM(
						ROOM_NO
						,HOUSE_NO
						,ROOM_NAME
						,GENDER
						,PEOPLE
						,AREA
						,DEPOSIT
						,RENT
						,EXPENSE
						,UTILITY
						,AVAILABLE_DATE
						,STATUS
					)
			VALUES(
						 SEQ_ROOM_NO.NEXTVAL
						,SEQ_HOUSE_NO.CURRVAL
						,#{roomName}
						,#{gender}
						,#{people}
						,#{area}
						,#{deposit}
						,#{rent}
						,#{expense}
						,#{utility}
						,#{availableDate}
						,DEFAULT
					)
	</insert>
	
  	<!-- 현재 방 번호 확인 -->
  	<select id="selectRoomNo" resultType="_int">
		SELECT 
		        LAST_NUMBER AS ROOM_NO
		FROM 
		        USER_SEQUENCES 
		WHERE 
		        SEQUENCE_NAME = 'SEQ_ROOM_NO'
  	</select>
  	
  	<!-- 방 삭제 -->
  	<update id="deleteRoom" parameterType="_int">
    	UPDATE
  				ROOM
  		SET
  				STATUS = 'N'
  		WHERE
  				ROOM_NO = #{roomNo}
  	</update>
	
	<select id="houseDetail" resultMap="roomResultSet">
			SELECT * 
			FROM ROOM 
			LEFT JOIN HOUSE USING(HOUSE_NO)
			WHERE HOUSE_NO = #{hno}
  	</select>
  	
  	<select id="selectRoom" parameterType="_int" resultMap="roomResultSet">
  		SELECT
  				*
  		FROM
  				ROOM
  		WHERE
  				HOUSE_NO = #{hno}
  		AND
  				STATUS = 'Y'
  	</select>
  	
  	<!-- 하우스 수정에서 방 등록 -->
	<insert id="updateInsertRoom" parameterType="room">
		INSERT
			INTO ROOM(
						ROOM_NO
						,HOUSE_NO
						,ROOM_NAME
						,GENDER
						,PEOPLE
						,AREA
						,DEPOSIT
						,RENT
						,EXPENSE
						,UTILITY
						,AVAILABLE_DATE
						,STATUS
					)
			VALUES(
						 SEQ_ROOM_NO.NEXTVAL
						,#{houseNo}
						,#{roomName}
						,#{gender}
						,#{people}
						,#{area}
						,#{deposit}
						,#{rent}
						,#{expense}
						,#{utility}
						,#{availableDate}
						,DEFAULT
					)
	</insert>
  	
</mapper>